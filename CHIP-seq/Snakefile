@startuml
!theme plain
skinparam defaultFontName Arial
skinparam defaultFontSize 10
skinparam arrow {
    Color DarkBlue
}
skinparam rectangle {
    BackgroundColor LightBlue
    BorderColor DarkBlue
}

start

:Raw FASTQ files\n(.fastq/.fastq.gz);
--> fastqc reports
:FastQC Quality Control\n(fastqc_raw);

--> .trimmed.fastq
:Adapter Trimming\n(trim_adapters)\nCutadapt - multiple adapters;

--> .alltrimmed.fastq
:Trimmomatic\n(trimmomatic)\nQuality & adapter trimming;

--> fastqc reports
:FastQC on Trimmed\n(fastqc_trimmed);

--> .fastq (50bp)
:Trim to 50bp\n(trim_to_50bp)\nPython script;

split
  :Genome Mapping Path;
  --> .sam
  :Bowtie Mapping to dm6\n(bowtie_mapping)\nv=2, k=1, m=1;
  
  --> .bam
  :SAM to BAM\n(samtools_view);
  
  --> .sorted_final.bam/.bai
  :Sort & Index BAM\n(samtools_sort_and_index);
  
  --> .mito_removed.bam
  :Remove Mitochondrial\n(remove_mitochondrial_reads)\nFilter chrM;
  
  --> .no_mito_sorted.bam/.bai
  :Sort No-Mito BAM\n(samtools_sort_no_mito);
  
  --> .rmdup.bam/.bai
  :Remove Duplicates\n(samtools_rmdup)\nMarkdup;
  
  split
    --> .bigwig
    :BigWig Generation\n(make_bigwig)\nWiggle → BigWig;
    --> .enrichment.bigwig
    :Enrichment Track\n(make_enrichment_track)\nChIP vs Input;
    --> .42AB/.20A.bg4
    :Transposon Coverage\n(bam_coverage_transposon)\n42AB & 20A regions;
  split end
  
split again
  :Vector Mapping Path;
  --> .vectoronly.sam
  :Bowtie Vector Mapping\n(bowtie_vector_mapping)\nMap to 42AB_UBIG;
  
  --> .vectoronly.bam
  :SAM to BAM Vector\n(samtools_view_vector);
  
  --> .vectoronly.dup.bam/.bai
  :Sort & Index Vector\n(samtools_sort_and_index_vector);
  
  --> .{binsize}.bg4 (Plus/Minus/Total)
  :Coverage Analysis\n(bam_coverage)\nMultiple bin sizes;
  
  --> .bg4.chopped.bg4
  :Chop Bedgraph\n(chop_bedgraph)\nBin chopping;
  
split end

:Final Outputs:\n• BigWig files\n• Enrichment tracks\n• Coverage bedgraphs\n• Transposon analysis;

stop

@enduml